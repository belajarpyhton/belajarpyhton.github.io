<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Python Mudah</title>
        <link rel="stylesheet" href="styling.css">
        <link rel="icon" href="pythonImg1.png" type="image/icon type">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    </head>
    <body style="background-color: #ced4da">
        <nav class="nav nav-pills flex-column flex-sm-row bg1">
            <!-- tombol sidebar-->
            <div class="align-content-between ml-4 text-light ml">
                <button class="btn btn-link" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasScrolling" aria-controls="offcanvasScrolling">
                    <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-list text-light" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M2.5 12a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5z"/>
                      </svg>
                </button>
            </div>
            <a class="flex-sm-fill text-sm-center nav-link text-light " aria-current="page" href="#">Python Mudah</a>
            <a class="flex-sm-fill text-sm-center nav-link text-light" href="landingLatihan.html">Latihan</a>
            <a class="flex-sm-fill text-sm-center nav-link text-light" href="#">Evaluasi</a>
            <a id="userlink" style="margin-right: 15px; " class="flex-sm-fill text-sm-center nav-link text-light" href="#"></a>
        </nav>
        <!-- side bar -->
        <div class="offcanvas offcanvas-start" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="offcanvasScrolling" aria-labelledby="offcanvasScrollingLabel">
            <!-- header sidebar -->
            <div class="offcanvas-header">
                <h5 class="offcanvas-title" id="offcanvasScrollingLabel">Pilihan Materi</h5>
                <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <!-- body sidebar -->
            <div class="offcanvas-body">
                <div class="accordion accordion-flush" id="accordionFlushExample">
                    <!-- Materi 1 -->
                    <div class="accordion-item">
                      <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseOne" aria-expanded="false" aria-controls="flush-collapseOne">
                          Pendahuluan
                        </button>
                      </h2>
                      <div id="flush-collapseOne" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
                        <table class="table table-striped">
                            <tbody><tr>
                                  <td>
                                      <a href="#" id="link"> <!-- sub materi 1 -->
                                          &ensp;&ensp;Sejarah
                                      </a>
                                  </td>
                                </tr>
                                <tr>
                                  <td>
                                      <a href="#" id="link"> <!-- sub materi 1 -->
                                          &ensp;&ensp;Pengenalan Syntax
                                      </a>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <a href="#" id="link"> <!-- sub materi 1 -->
                                           &ensp;&ensp;Kuis
                                        </a>
                                      </td>
                                </tr>
                            </tbody></table>
                      </div>
                    </div>
                    <!-- Materi 2 -->
                    <div class="accordion-item">
                      <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwo" aria-expanded="false" aria-controls="flush-collapseTwo">
                          Percabangan
                        </button>
                      </h2>
                      <div id="flush-collapseTwo" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
                        <table class="table table-striped">
                            <tbody><tr>
                                  <td>
                                      <a href="#" id="link"> <!-- sub materi 2 -->
                                          &ensp;&ensp;Pengertian
                                      </a>
                                  </td>
                                </tr>
                                <tr>
                                  <td>
                                      <a href="#" id="link"> <!-- sub materi 2 -->
                                          &ensp;&ensp;Jenis-Jenis
                                      </a>
                                    </td>
                                </tr>
                                <tr>
                                    <td>
                                        <a href="#" id="link"> <!-- sub materi 2 -->
                                           &ensp;&ensp;Kuis
                                        </a>
                                      </td>
                                </tr>
                            </tbody></table>
                      </div>
                    </div>
                    <!-- Materi 3 -->
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseThree" aria-expanded="false" aria-controls="flush-collapseThree">
                            Perulangan
                          </button>
                        </h2>
                        <div id="flush-collapseThree" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
                            <table class="table table-striped">
                                <tbody><tr>
                                      <td>
                                          <a href="#" id="link"> <!-- sub materi 3 -->
                                              &ensp;&ensp;Pengertian
                                          </a>
                                      </td>
                                    </tr>
                                    <tr>
                                      <td>
                                          <a href="#" id="link"> <!-- sub materi 3 -->
                                              &ensp;&ensp;Jenis-Jenis
                                          </a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <a href="#" id="link"> <!-- sub materi 3 -->
                                               &ensp;&ensp;Kuis
                                            </a>
                                          </td>
                                    </tr>
                                </tbody></table>
                        </div>
                      </div>
                      <!-- Materi 4 -->
                      <div class="accordion-item">
                        <h2 class="accordion-header">
                          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseFour" aria-expanded="false" aria-controls="flush-collapseFour">
                            Fungsi
                          </button>
                        </h2>
                        <div id="flush-collapseFour" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample">
                            <table class="table table-striped">
                                <tbody><tr>
                                      <td>
                                          <a href="#" id="link"> <!-- sub materi 4 -->
                                              &ensp;&ensp;Pengertian
                                          </a>
                                      </td>
                                    </tr>
                                    <tr>
                                      <td>
                                          <a href="#" id="link"> <!-- sub materi 4 -->
                                              &ensp;&ensp;Cara Menggunakan
                                          </a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <a href="#" id="link"> <!-- sub materi 4 -->
                                               &ensp;&ensp;Kuis
                                            </a>
                                          </td>
                                    </tr>
                                </tbody></table>
                        </div>
                    </div>
                    <!-- Materi 5 -->
                      <div class="accordion-item"> <!-- Tag buka accordion item -->
                        <h2 class="accordion-header">
                          <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseFive" aria-expanded="false" aria-controls="flush-collapseFive">
                            List
                          </button>
                        </h2>
                        <div id="flush-collapseFive" class="accordion-collapse collapse" data-bs-parent="#accordionFlushExample"> <!-- Tag buka isi accordion -->
                            <table class="table table-striped">
                                <tbody><tr>
                                      <td>
                                          <a href="#" id="link"> <!-- sub materi 4 -->
                                              &ensp;&ensp;Pengertian
                                          </a>
                                      </td>
                                    </tr>
                                    <tr>
                                      <td>
                                          <a href="#" id="link"> <!-- sub materi 4 -->
                                              &ensp;&ensp;Jenis-Jenis
                                          </a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <a href="#" id="link"> <!-- sub materi 4 -->
                                               &ensp;&ensp;Kuis
                                            </a>
                                          </td>
                                    </tr>
                                </tbody></table>
                        </div> <!-- Tag tutup isi accordion -->
                      </div> <!-- Tag tutup accordion item -->
                </div>
            </div> <!-- Tag tutup off canvas body accordion -->
        </div><!-- Tag tutup off canvas accordion -->        
        <div class="container">
            <!-- Stack the columns on mobile by making one full-width and the other half-width -->
            <div class="row">
                <!-- konten soal -->
              <div class="col-lg-12">
                <div class="card text-bg-light mt-5">
                    <div class="card-header">
                      <h4 class="card-title">Soal Evaluasi</h4>
                    </div>
                    <div class="card-body">
                      <button id="timer" class="btn btn-primary mb-3"></button>
                      <p class="card-text" id="soal" style="font-size: 20px;"></p>
                      <input type="radio" name="opsi" id="Opsi1"><label class="ml3" for="Opsi1" id="opsi_1"></label><br>
                      <input type="radio" name="opsi" id="Opsi2"><label class="ml3" for="Opsi1" id="opsi_2"></label><br>
                      <input type="radio" name="opsi" id="Opsi3"><label class="ml3" for="Opsi1" id="opsi_3"></label><br>
                      <input type="radio" name="opsi" id="Opsi4"><label class="ml3" for="Opsi1" id="opsi_4"></label><br>
                    </div>
                </div>
                <button id="prevButton" class="btn btn-primary mt-4">Prev</button>
                <button id="nextButton" class="btn btn-primary mt-4">Next</button>
                <button id="sub-btn" style="display: none;" class="btn btn-success mt-4">Selesai</button>
              </div>
            </div>
            <div id="result"></div>
        </div>
        
    <script>
    //tampilan nama user atau pengguna
    var pengguna = sessionStorage.getItem("fullname");
    var namaPengguna = document.getElementById("userlink");
    namaPengguna.innerText = pengguna;
    // Array of questions
    let questions = [
    {
    question: "1. Python dikembangkan oleh Guido van Rossum pada tahun....",
    options: ["A. 1991", "B. 1990", "C. 1992", "D. 1993"],
    answer: 2
    },
    {
    question: "2. Baris perintah yang dieksekusi ialah....",
    options: ["A. Statement", "B. Komentar", "C. Syntax", "D. Variabel"],
    answer: 1
    },
    {
    question: "3. Cara menuliskan kondisi a sama dengan b pada python ialah....",
    options: ["A. a = b", "B. a == b", "C. a != b", "D. a === b"],
    answer: 2
    },
    {
    question: "4. Menentukan tindakan apa yang akan diambil sesuai dengan kondisi pengertian dari....",
    options: ["A. Percabangan", "B. Perulangan", "C. List", "D. Fungsi"],
    answer: 1
    },
    {
      question: "5. Struktur kontrol yang secara berulang mengeksekusi suatu himpunan pernyataan. Artinya program akan melaksanakan satu atau lebih pernyataan berkali-kali, sampai kondisi tertentu dipenuhi. Merupakan pengertian dari....",
      options: ["A. Perulangan", "B. Percabangan", "C. Fungsi", "D. List"],
      answer: 1
      },
    {
      question: "6. Perulangan yang dapat terjadi perulangan tak terhingga ialah perulangan....",
      options: ["A. While", "B. For", "C. Nested For", "D. Infinite Loop"],
      answer: 1
      },
    {
      question: "7. Daftar variabel yang menyimpan nilai yang diteruskan ke fungsi ialah....",
      options: ["A. List of List", "B. List", "C. Statement", "D. Parameter"],
      answer: 4
      },    
    {
      question: "8. Fungsi diawali dengan kata kunci....",
      options: ["A. function", "B. def", "C. fungsi", "D. definition"],
      answer: 2
      },
    {
      question: "9. myList = ['fisika','kimia','matematika','biologi'] kata kimia terletak pada index....",
      options: ["A. 0", "B. 1", "C. 3", "D. 2"],
      answer: 2
      },
    {
      question: "10. angka = [2,4,1,3,4,5,7,2,3] berapakah nilai dari index ke-4....",
      options: ["A. 4", "B. 5", "C. 3", "D. 1"],
      answer: 1
      },
    ];
    let nilaiEvaluasi = 0;
    let currentQuestion = 0;
    let totalQuestions = questions.length;
    let timeRemaining = 900; // 15 minutes in seconds
    
    // Define an array to store selected answers
    let selectedAnswers = new Array(totalQuestions).fill(null);
    // Function to display the current question
    // Function to display the current question
    function displayQuestion() {
      let questionElement = document.getElementById("soal");
      let option1Element = document.getElementById("Opsi1");
      let option2Element = document.getElementById("Opsi2");
      let option3Element = document.getElementById("Opsi3");
      let option4Element = document.getElementById("Opsi4");

      questionElement.textContent = questions[currentQuestion].question;
      option1Element.value = questions[currentQuestion].options[0];
      document.getElementById("opsi_1").innerHTML = questions[currentQuestion].options[0];
      option2Element.value = questions[currentQuestion].options[1];
      document.getElementById("opsi_2").innerHTML = questions[currentQuestion].options[1];
      option3Element.value = questions[currentQuestion].options[2];
      document.getElementById("opsi_3").innerHTML = questions[currentQuestion].options[2];
      option4Element.value = questions[currentQuestion].options[3];
      document.getElementById("opsi_4").innerHTML = questions[currentQuestion].options[3];

      // Check if an answer has been previously selected for this question
      let selectedAnswerIndex = selectedAnswers[currentQuestion];
      if (selectedAnswerIndex !== null && selectedAnswerIndex >= 0 && selectedAnswerIndex <= 3) {
        // Set the corresponding radio button as checked
        document.getElementById("Opsi" + (selectedAnswerIndex + 1)).checked = true;
      } else {
        // If no answer has been selected, uncheck all radio buttons
        option1Element.checked = false;
        option2Element.checked = false;
        option3Element.checked = false;
        option4Element.checked = false;
      }
    }
    // Function to check the answer
    function checkAnswer() {
      let selectedOption = document.querySelector('input[name="opsi"]:checked');
      if (selectedOption) {
        let selectedAnswer = parseInt(selectedOption.id.slice(-1));
        if (selectedAnswer === questions[currentQuestion].answer) {
            nilaiEvaluasi += 10;
            sessionStorage.setItem('evaluasi', nilaiEvaluasi)
            }
       }
      }
      let prevButton = document.getElementById("prevButton");
      prevButton.style.display = "none"; // Hide the button initially

      // Event listener for previous button
      prevButton.addEventListener("click", function () {
      if (currentQuestion > 0) {
          saveSelectedAnswer();
          currentQuestion--;
          displayQuestion();
          updateButtonVisibility();
          prevButton.style.display = currentQuestion > 0 ? "inline" : "none";
      }
  });
  function saveSelectedAnswer() {
    let selectedOption = document.querySelector('input[name="opsi"]:checked');
    if (selectedOption) {
        selectedAnswers[currentQuestion] = parseInt(selectedOption.id.slice(-1)) - 1;
    }
}
    // Event listener for next button
    document.getElementById("nextButton").addEventListener("click", function() {
    saveSelectedAnswer();
    checkAnswer();
    currentQuestion++;
    if (currentQuestion >= totalQuestions) {
        currentQuestion = 0;
    }
    displayQuestion();
    updateButtonVisibility();
    prevButton.style.display = "inline";
  });
    // Function to handle time up
      function timeUp() {
      checkAnswer();
      alert("Waktu telah habis. Evaluasi Anda selesai. Nilai Evaluasi: " + nilaiEvaluasi);
    // Perform any necessary actions after evaluation finishes
    }

    // Update timer every second
    let timer = setInterval(function() {
    timeRemaining--;
    let minutes = Math.floor(timeRemaining / 60);
    let seconds = timeRemaining % 60;
    document.getElementById("timer").textContent = "Waktu Tersisa: " + minutes + " menit " + seconds + " detik";
    if (timeRemaining <= 0) {
    clearInterval(timer);
    timeUp();
    }
    }, 1000);

    // Function button untuk next dan kembali
    function updateButtonVisibility() {
    let nextButton = document.getElementById("nextButton");
    let finishButton = document.getElementById("sub-btn");
    if (currentQuestion === totalQuestions - 1) {
      nextButton.style.display = "inline";
      finishButton.style.display = "inline";
    } 
  }
    // Display the first question on page load
    displayQuestion();
    updateButtonVisibility();

    //kode untuk hasil
    let resultElement = document.getElementById("result");
    //Event listener untuk tombol selesai ujian
    document.getElementById("sub-btn").addEventListener("click", function() {
        clearInterval(timer);
        checkAnswer();
        let message;
        if (nilaiEvaluasi > 60) {
            message = "Evaluasi Anda selesai. Nilai Evaluasi: " + nilaiEvaluasi;
        } else {
            message = "Evaluasi Anda selesai. Nilai Evaluasi: " + nilaiEvaluasi;
        }
    // Tampilkan pesan dalam elemen hasil
    resultElement.textContent = message;
    // Nonaktifkan tombol sebelumnya
    prevButton.disabled = true;
    nextButton.disabled = true
    });
    </script>
    <script type="module" >
      
        // --------------------References---------------------------
            const submit = document.getElementById('sub-btn');
            var currentUser = null;
            var currentFullName = null;
            var currentNim = null;
            var currentClass = null;
            var currentEvaluasi = null;
        
         //------------------FIREBASE CONFIG------------------------
            // Import the functions you need from the SDKs you need
            import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";
           // TODO: Add SDKs for Firebase products that you want to use
            import { getDatabase, ref, set, push, get, child, onValue, update, remove } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js";
        
          
            // Your web app's Firebase configuration
            const firebaseConfig = {
              apiKey: "AIzaSyDCC8qgldlOSiMUZNlocgTbsketEd5kM0I",
              authDomain: "tugasakhirweb1.firebaseapp.com",
              projectId: "tugasakhirweb1",
              storageBucket: "tugasakhirweb1.appspot.com",
              messagingSenderId: "729508669892",
              appId: "1:729508669892:web:6ed7c489cef898ec68dc91"
            };
        
            // Initialize Firebase 
            const app = initializeApp(firebaseConfig);
        
            const db = getDatabase();
        
        
        // ----------------------Function-----------------
        
            function getUsername(){
                currentUser = sessionStorage.getItem('username');
                currentFullName = sessionStorage.getItem('fullname');
                currentNim = sessionStorage.getItem('nim');
                currentClass = sessionStorage.getItem('class');
                currentEvaluasi= sessionStorage.getItem('evaluasi');
            }
        
        
            //-------------- update progres function in database---------------
              function UpdateData() {
                  getUsername();
                  if(currentEvaluasi > 0){
                    update(ref(db, "UserList/"+ currentUser),{
                    evaluasi : currentEvaluasi
                  })
                  .then(()=>{
                    swal({
                            title: "Perhatian!",
                            text: "Nilai Evaluasi sudah di update.",
                            icon: "success",
                            button: "Lanjutkan",
                          });
        
                  })
                  .catch((error)=>{
                    swal({
                            title: "Maaf!",
                            text: "unsucsessful, error"+error,
                            icon: "error",
                            button: "Lanjutkan",
                          });
                  });
                }
                else{
                    update(ref(db, "UserList/"+ currentUser),{
                        evaluasi : currentEvaluasi
                      })
                      .then(()=>{
                        swal({
                            title: "Silahkan!",
                            text: "Kerjakan Latihannya ya!",
                            icon: "warning",
                            button: "Lanjutkan",
                              });
                      })
                      .catch((error)=>{
                        swal({
                                title: "Maaf!",
                                text: "unsucsessful, error"+error,
                                icon: "error",
                                button: "Lanjutkan",
                              });
                      });	    
                  }
                }
              
      // --------------------ASSIGN THE EVENTS---------------------
        
      submit.addEventListener('click', UpdateData);
    </script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    </body>
</html>