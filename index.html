<!DOCTYPE html>
<html>
    <head>
        <title>Python Mudah</title>
        <link href="https://fonts.googleapis.com/css2?family=Anton&family=Montserrat:wght@100&family=Nunito:wght@500&family=Roboto:wght@100;700&family=Secular+One&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="style.css">
        <link rel="icon" href="pythonImg1.png" type="image/icon type">
    </head>
    <body>
        <nav>
            <div class = "Judul">
                <h4>Python Mudah</h4>
            </div>
            <ul>
                <li><a href = "about.html" class = "nav1">About</a></li>
                <li><a href = "halamanLogin.html" class = "nav2">Login</a></li>
            </ul>
        </nav>
        <div class = "container_1">
            <div class = "content_kiri">
                <h2 class = "ajakan">Mari Belajar</h2>
                <h2 class = "ajakan2">Bahasa Python</h2>
                <p class = "kalimat1">Buka pintu pengetahuan Untuk Masa depan</p>
                <a href = "halamanLogin.html" class="mulai"><div class = "kotak"><p>Mulai Belajar</p></div></a>
            </div>
            <div class ="content_kanan">
                <img src ="pythonImg1.png" class="gambar">
            </div>
        </div>
        <script type="module">
            // Import the functions you need from the SDKs you need
            import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
            // TODO: Add SDKs for Firebase products that you want to use
            // https://firebase.google.com/docs/web/setup#available-libraries    
            // Your web app's Firebase configuration
            // TODO: Add SDKs for Firebase products that you want to use
            import { getDatabase, ref, set, push, get, child, onValue, update, remove } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js";
            const firebaseConfig = {
              apiKey: "AIzaSyDCC8qgldlOSiMUZNlocgTbsketEd5kM0I",
              authDomain: "tugasakhirweb1.firebaseapp.com",
              projectId: "tugasakhirweb1",
              storageBucket: "tugasakhirweb1.appspot.com",
              messagingSenderId: "729508669892",
              appId: "1:729508669892:web:6ed7c489cef898ec68dc91"
            };
          
            // Initialize Firebase
            const app = initializeApp(firebaseConfig);        
      
        // <!--------------------FIREBASE CONFIG--------------- -->
          const db = getDatabase(app); 
      
      // ---------------------- The References----------------
      
          const username = document.getElementById('userInp');
          console.log(username);
          const pass = document.getElementById('passInp');
          const submit = document.getElementById('sub_btn');
      
      // ---------------------Authentication-------------------
      
         
      function AuntheticateUser(){
        const dbref = ref(db);

        get(child(dbref, "UserList/"+ username.value.replace(/\./g, ','))).then((snapshot)=>{
          if(snapshot.exists()){

            let dbpass = snapshot.val().password;
            let dbuser = snapshot.val().username;
            let dbnama = snapshot.val().fullname;
            let dbclass = snapshot.val().class;
            let dbnim = snapshot.val().nim;
            let dblatihan = snapshot.val().latihan;


            console.log(dbpass);
            console.log(dbuser);
            if (dbpass == pass.value) {
              Signin();
              sessionStorage.setItem('username', dbuser);
              sessionStorage.setItem('password', dbpass);
              sessionStorage.setItem('fullname', dbnama);;
              sessionStorage.setItem('class',dbclass)
              sessionStorage.setItem('nim', dbnim);
              sessionStorage.setItem('latihan', dblatihan);
              
              login(snapshot.val());
            }

            else{
              swal({
              title: "Perhatian!",
              text: "Nama Pengguna atau Password yang anda masukan salah.",
              icon: "warning",
              button: "Lanjutkan",
            });
              
            } 
          }

          else{
            swal({
              title: "Perhatian!",
              text: "Nama Pengguna atau Password yang anda masukan salah.",
              icon: "warning",
              button: "Lanjutkan",
            });
            
            
          }
        });
      }
        </script>
        <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>    
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    </body>
</html>